models:

  - name: base_nascar__nascar_results
    description: >
      - base model for all stages
      - same description as sources, columns as well
    columns:
      - name: year
        data_type: varchar
      - name: race_num
        data_type: varchar
      - name: track
        data_type: varchar
      - name: track_type
        data_type: varchar
      - name: fin
        data_type: varchar
      - name: start
        data_type: varchar
      - name: car_num
        data_type: varchar
      - name: driver
        data_type: varchar
      - name: manu
        data_type: varchar
      - name: team_name
        data_type: varchar
      - name: laps
        data_type: varchar
      - name: laps_led
        data_type: varchar
      - name: status
        data_type: varchar
      - name: points
        data_type: varchar
      - name: stage_1
        data_type: varchar
      - name: stage_2
        data_type: varchar
      - name: stage_3_or_duel
        data_type: varchar
      - name: stage_points
        data_type: varchar

  - name: stg_nascar__car_manufacturer
    description: "model for car manufacturer"
    columns:
      - name: car_manufacturer_id
        data_type: varchar
        description: "id"
        data_tests:
          - not_null
          - unique
      - name: car_manufacturer_name
        data_type: varchar
        description: "car's manufacturer name"
        data_tests:
          - not_null

  - name: stg_nascar__team
    description: "model for teams"
    columns:
      - name: team_id
        data_type: varchar
        description: "id"
        data_tests:
          - not_null
          - unique
      - name: team_name
        data_type: varchar
        description: "name of the team which fielded the driver and car in a particular observation"
        data_tests:
          - not_null

  - name: stg_nascar__track_type
    description: "every track type"
    columns:
      - name: track_type_id
        data_type: varchar
        description: "id"
        data_tests:
          - not_null
          - unique
      - name: track_type_name
        data_type: varchar
        description: "name of the track type"
        data_tests:
          - not_null
          
  - name: stg_nascar__season
    description: "year since we have data"
    columns:
      - name: season_id
        data_type: varchar
        description: "id"
        data_tests:
          - not_null
          - unique
      - name: season_year
        data_type: number
        description: "year"
        data_tests:
          - not_null

  - name: stg_nascar__race_status
    description: "finishing status of the driver: Completed, DQ or DNF"
    columns:
      - name: race_status_id
        data_type: varchar
        description: "id"
        data_tests:
          - not_null
          - unique
      - name: race_status_desc
        data_type: varchar
        description: "see model description"
        data_tests:
          - not_null
    
  - name: stg_nascar__track
    description: track where there was a race
    columns:
      - name: track_id
        data_type: varchar
        description: id of the track
        data_tests:
          # - unique  -- we have 2 atlantas with different track type
          - not_null
      - name: track_type_id
        data_type: varchar
        description: id from track_type model
        data_tests:
          - relationships:
                arguments: 
                  to: ref('stg_nascar__track_type')
                  field: track_type_id
      - name: track_name
        data_type: varchar
        description: shortened name of the track at which the observation took place
        data_tests:
          - not_null