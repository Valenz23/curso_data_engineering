models:

  - name: stg_nascar__car
    description: "car stg model"
    columns:
      - name: car_id
        data_type: varchar
        description: "car's id"
        data_tests:
          - not_null
          - unique
      - name: car_manufacturer
        data_type: varchar
        description: "car's manufacturer name"
        data_tests:
          - not_null
      - name: car_number
        data_type: number
        description: "car number"
        data_tests:
          - not_null
          - check_car_num       # generic test
      - name: synced_at
        data_type: timestamp_tz
        description: "loaded date"
        data_tests:
          - not_null

  - name: stg_nascar__driver
    description: "driver stg model"
    columns:
      - name: driver_id
        data_type: varchar
        description: "driver's id"
        data_tests:
          - unique
          - not_null
      - name: driver_name
        data_type: varchar
        description: "driver's name"
        data_tests:
          - not_null
      - name: synced_at
        data_type: timestamp_tz
        description: "loaded date"
        data_tests:
          - not_null

  - name: stg_nascar__team
    description: "team stg model"
    columns:
      - name: team_id
        data_type: varchar
        description: "team's id"
        data_tests:
          - unique
          - not_null
      - name: team_name
        data_type: varchar
        description: "name of the team"
        data_tests:
          - not_null
      - name: synced_at
        data_type: timestamp_tz
        description: "loaded date"
        data_tests:
          - not_null

  - name: stg_nascar__track
    description: "track stg model"
    columns:
      - name: track_id
        data_type: varchar
        description: "track's id"
        data_tests:
          - unique
          - not_null
      - name: track_name
        data_type: varchar
        description: "name of the track"
        data_tests:
          - not_null
      - name: track_type_desc
        data_type: varchar
        description: "track surface desc"
        data_tests:
          - not_null
      - name: synced_at
        data_type: timestamp_tz
        description: "loaded date"
        data_tests:
          - not_null

  - name: stg_nascar__season
    description: "stg season model"
    columns:
      - name: season_id
        data_type: varchar
        description: "season's id"
        data_tests:
          - unique
          - not_null
      - name: season_year
        data_type: number
        description: "year of the season"
        data_tests:
          - not_null
      - name: synced_at
        data_type: timestamp_tz
        description: "loaded date"
        data_tests:
          - not_null

  - name: stg_nascar__race_type
    description: "race type stg model"
    columns:
      - name: race_type_id
        data_type: varchar
        description: "id"
        data_tests:
          - not_null
          - unique
      - name: race_type_desc
        data_type: varchar
        description: "description of the race in season"
        data_tests:
          - not_null
      - name: synced_at
        data_type: timestamp_tz
        description: "loaded date"
        data_tests:
          - not_null

  - name: stg_nascar__race_status
    description: "race status stg model"
    columns:
      - name: race_status_id
        data_type: varchar
        description: "id"
        data_tests:
          - not_null
          - unique
      - name: race_status_desc
        data_type: varchar
        description: "driver's way of finishing the race"
        data_tests:
          - not_null
      - name: synced_at
        data_type: timestamp_tz
        description: "loaded date"
        data_tests:
          - not_null

  - name: stg_nascar__race
    description: "race stg model"
    columns:
      - name: race_id
        data_type: varchar
        description: "race's id"
        data_tests:
          - unique
          - not_null
      - name: season_id
        data_type: varchar
        description: "season's id"
        data_tests:
          - relationships:
              arguments: 
                to: ref('stg_nascar__season')
                field: season_id       
      - name: track_id
        data_type: varchar
        description: "track's id"
        data_tests:
          - relationships:
              arguments: 
                to: ref('stg_nascar__track')
                field: track_id  
      - name: race_type_id
        data_type: varchar
        description: ""
        data_tests:
          - relationships:
              arguments: 
                to: ref('stg_nascar__race_type')
                field: race_type_id  
      - name: race_num
        data_type: number
        description: "number of the race in season"
        data_tests:
          - not_null
          - check_race_num
      - name: synced_at
        data_type: timestamp_tz
        description: "loaded date"
        data_tests:
          - not_null

  - name: stg_nascar__race_performance
    description: "race performance of the driver"
    columns:
      - name: race_id
        data_type: varchar
        description: "race id"
        data_tests:
          - relationships:
              arguments: 
                to: ref('stg_nascar__race')
                field: race_id
      - name: driver_id
        data_type: varchar
        description: "driver id"
        data_tests:
          - relationships:
              arguments: 
                to: ref('stg_nascar__driver')
                field: driver_id
      - name: team_id
        data_type: varchar
        description: "team id"
        data_tests:
          - relationships:
              arguments: 
                to: ref('stg_nascar__team')
                field: team_id
      - name: car_id
        data_type: varchar
        description: "car id"
        data_tests:
          - relationships:
              arguments: 
                to: ref('stg_nascar__car')
                field: car_id
      - name: race_status_id
        data_type: varchar
        description: "race status id"
        data_tests:
          - relationships:
              arguments: 
                to: ref('stg_nascar__race_status')
                field: race_status_id
      - name: start_pos
        data_type: number
        description: "start position in race"
      - name: final_pos
        data_type: number
        description: "final position in race"
      - name: stage_1_pos
        data_type: number
        description: "stage 1 position"
      - name: stage_2_pos
        data_type: number
        description: "stage 2 position"
      - name: stage_3_or_duel_pos
        data_type: number
        description: "stage 3 or duel position"
      - name: laps_completed
        data_type: number
        description: "laps completed"
      - name: laps_led
        data_type: number
        description: "laps leaded"
      - name: stage_points
        data_type: number
        description: "stage points awarded"
      - name: playoff_points
        data_type: number
        description: "playoff points"
      - name: points
        data_type: number
        description: "points"
      - name: total_points
        data_type: number
        description: "sum of stage points + playoff points and points"
      - name: synced_at
        data_type: timestamp_tz
        description: "loaded date"
        data_tests:
          - not_null        
